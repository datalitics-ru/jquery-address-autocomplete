!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){var s,n,o;!function(a){"use strict";n=[i(1)],void 0===(o="function"==typeof(s=function(t){var e={escapeRegExChars:function(t){return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},clearText:function(t){return t.replace(/(?:(?![\t-\r 0-9a-z\xA0\u017F\u0430-\u044F\u0451\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u212A\u3000\uFEFF])[\s\S])+/gim," ").replace(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/gim," ")},createNode:function(t){var e=document.createElement("div");return e.className=t,e.style.position="absolute",e.style.display="none",e}},i=27,s=9,n=13,o=38,a=39,u=40,r=t.noop;function l(e,i){this.element=e,this.el=t(e),this.suggestions=[],this.badQueries=[],this.selectedIndex=-1,this.currentValue=this.element.value,this.timeoutId=null,this.cachedResponse={},this.onChangeTimeout=null,this.onChange=null,this.suggestionsContainer=null,this.noSuggestionsContainer=null,this.options=t.extend(!0,{},l.defaults,i),this.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},this.hint=null,this.hintValue="",this.selection=null,this.initialize(),this.setOptions(i)}l.utils=e,t.Autocomplete=l,l.defaults={autoSelectFirst:!1,showLogo:!0,appendTo:"body",addressType:"adm",onSelect:null,onHint:null,width:"auto",minChars:2,maxHeight:700,deferRequestBy:0,formatResult:function(t,i){if(!i)return t.address_value;var s=e.clearText(i).split(" ");return t.address_value.replace(new RegExp("("+s.join("|")+")","gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")},formatGroup:function(t,e){return'<div class="autocomplete-group">'+e+"</div>"},getGroup:null,delimiter:null,zIndex:9999,noCache:!1,onSearchStart:r,onSearchComplete:r,onSearchError:r,preserveInput:!1,containerClass:"autocomplete-suggestions",inputClass:"autocomplete-input",tabDisabled:!1,currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,transformResult:function(e){return"string"==typeof e?t.parseJSON(e):e},showNoSuggestionNotice:!0,noSuggestionNotice:"Нет результатов",suggestionPrefix:"Выберите адрес или продолжите ввод",orientation:"bottom",forceFixPosition:!1},l.prototype={initialize:function(){var e,i=this,s="."+i.classes.suggestion,n=i.classes.selected,o=i.options;i.element.setAttribute("autocomplete","off"),i.element.classList.add(o.inputClass),i.noSuggestionsContainer=t('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0),i.suggestionsContainer=l.utils.createNode(o.containerClass),(e=t(i.suggestionsContainer)).append('<div class="dl-items"></div>'),o.showLogo&&e.append('<div class="dl-logo"><a href="https://datalitics.ru"><img alt="Даталитикс" src="https://api.datalitics.ru/assets/logo_color_100.png"></a></div>'),e.appendTo(o.appendTo||"body"),"auto"!==o.width&&e.css("width",o.width),e.on("mouseover.autocomplete",s,(function(){i.activate(t(this).data("index"))})),e.on("mouseout.autocomplete",(function(){i.selectedIndex=-1,e.children("."+n).removeClass(n)})),e.on("click.autocomplete",s,(function(){i.select(t(this).data("index"))})),e.on("click.autocomplete",(function(){clearTimeout(i.blurTimeoutId)})),i.fixPositionCapture=function(){i.visible&&i.fixPosition()},t(window).on("resize.autocomplete",i.fixPositionCapture),i.el.on("keydown.autocomplete",(function(t){i.onKeyPress(t)})),i.el.on("keyup.autocomplete",(function(t){i.onKeyUp(t)})),i.el.on("blur.autocomplete",(function(){i.onBlur()})),i.el.on("focus.autocomplete",(function(){i.onFocus()})),i.el.on("change.autocomplete",(function(t){i.onKeyUp(t)})),i.el.on("input.autocomplete",(function(t){i.onKeyUp(t)}))},onFocus:function(){this.disabled||(this.fixPosition(),this.el.val().length>=this.options.minChars&&this.onValueChange())},onBlur:function(){var e=this,i=e.options,s=e.el.val(),n=e.getQuery(s);e.blurTimeoutId=setTimeout((function(){e.hide(),e.selection&&e.currentValue!==n&&(i.onInvalidateSelection||t.noop).call(e.element)}),200)},abortAjax:function(){this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null)},setOptions:function(e){var i=t.extend({},this.options,e);i.orientation=this.validateOrientation(i.orientation,"bottom"),t(this.suggestionsContainer).css({"max-height":i.maxHeight+"px",width:i.width+"px","z-index":i.zIndex}),this.options=i},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){this.disabled=!0,clearTimeout(this.onChangeTimeout),this.abortAjax()},enable:function(){this.disabled=!1},fixPosition:function(){var e=t(this.suggestionsContainer),i=e.parent().get(0);if(i===document.body||this.options.forceFixPosition){var s=this.options.orientation,n=e.outerHeight(),o=this.el.outerHeight(),a=this.el.offset(),u={top:a.top,left:a.left};if("auto"===s){var r=t(window).height(),l=t(window).scrollTop(),h=-l+a.top-n,c=l+r-(a.top+o+n);s=Math.max(h,c)===h?"top":"bottom"}if(u.top+="top"===s?-n:o,i!==document.body){var d,g=e.css("opacity");this.visible||e.css("opacity",0).show(),d=e.offsetParent().offset(),u.top-=d.top,u.top+=i.scrollTop,u.left-=d.left,this.visible||e.css("opacity",g).hide()}"auto"===this.options.width&&(u.width=this.el.outerWidth()+"px"),e.css(u)}},isCursorAtEnd:function(){var t,e=this.el.val().length,i=this.element.selectionStart;return"number"==typeof i?i===e:!document.selection||((t=document.selection.createRange()).moveStart("character",-e),e===t.text.length)},onKeyPress:function(t){if(this.disabled||this.visible||t.which!==u||!this.currentValue){if(!this.disabled&&this.visible){switch(t.which){case i:this.el.val(this.currentValue),this.hide();break;case a:if(this.hint&&this.options.onHint&&this.isCursorAtEnd()){this.selectHint();break}return;case s:if(this.hint&&this.options.onHint)return void this.selectHint();if(-1===this.selectedIndex)return void this.hide();if(this.select(this.selectedIndex),!1===this.options.tabDisabled)return;break;case n:if(-1===this.selectedIndex)return void this.hide();this.select(this.selectedIndex);break;case o:this.moveUp();break;case u:this.moveDown();break;default:return}t.stopImmediatePropagation(),t.preventDefault()}}else this.suggest()},onKeyUp:function(t){var e=this;if(!e.disabled){switch(t.which){case o:case u:return}clearTimeout(e.onChangeTimeout),e.currentValue!==e.el.val()&&(e.findBestHint(),e.options.deferRequestBy>0?e.onChangeTimeout=setTimeout((function(){e.onValueChange()}),e.options.deferRequestBy):e.onValueChange())}},onValueChange:function(){if(this.ignoreValueChange)this.ignoreValueChange=!1;else{var e=this.options,i=this.el.val(),s=this.getQuery(i);this.selection&&this.currentValue!==s&&(this.selection=null,(e.onInvalidateSelection||t.noop).call(this.element)),clearTimeout(this.onChangeTimeout),this.currentValue=i,this.selectedIndex=-1,e.triggerSelectOnValidInput&&this.isExactMatch(s)?this.select(0):s.length<e.minChars?this.hide():this.getSuggestions(s)}},isExactMatch:function(t){var e=this.suggestions;return 1===e.length&&e[0].value.toLowerCase()===t.toLowerCase()},getQuery:function(e){var i,s=this.options.delimiter;return s?(i=e.split(s),t.trim(i[i.length-1])):e},getSuggestions:function(e){var i,s,n=this,o=n.options,a="https://api.datalitics.ru/v1/address/"+o.addressType+"/suggest",u={};u.q=e,!1!==o.onSearchStart.call(n.element,u)&&(s=a+"?"+t.param(u||{}),(i=n.cachedResponse[s])&&Array.isArray(i)?(n.suggestions=i,n.suggest(),o.onSearchComplete.call(n.element,e,n.suggestions)):n.isBadQuery(e)?(this.noSuggestions(),o.onSearchComplete.call(n.element,e,[])):(n.abortAjax(),n.currentRequest=t.ajax({url:a,data:u,type:"GET",dataType:"text"}).done((function(t){var i;n.currentRequest=null,i=o.transformResult(t,e),n.processResponse(i,e,s),o.onSearchComplete.call(n.element,e,i.suggestions)})).fail((function(t,i,s){o.onSearchError.call(n.element,e,t,i,s)}))))},isBadQuery:function(t){if(!this.options.preventBadQueries)return!1;for(var e=this.badQueries,i=e.length;i--;)if(0===t.indexOf(e[i]))return!0;return!1},hide:function(){var e=t(this.suggestionsContainer);t.isFunction(this.options.onHide)&&this.visible&&this.options.onHide.call(this.element,e),this.visible=!1,this.selectedIndex=-1,clearTimeout(this.onChangeTimeout),t(this.suggestionsContainer).hide(),this.onHint(null)},suggest:function(){if(this.suggestions.length){var e,i=this.options,s=i.formatResult,n=this.getQuery(this.currentValue),o=this.classes.suggestion,a=this.classes.selected,u=t(this.suggestionsContainer),r=t(this.noSuggestionsContainer),l=i.beforeRender,h="";i.triggerSelectOnValidInput&&this.isExactMatch(n)?this.select(0):(t.each(this.suggestions,(function(a,u){t.isFunction(i.getGroup)&&(h+=function(t,s){var n=i.getGroup(t,s);return e===n?"":(e=n,i.formatGroup(t,e))}(u,n)),h+='<div class="'+o+'" title="'+u.address_value+'" data-index="'+a+'">'+s(u,n,a)+"</div>"})),this.adjustContainerWidth(),r.detach(),u.find(".dl-items").html(h),t.isFunction(l)&&l.call(this.element,u,this.suggestions),this.fixPosition(),0===u.find(".dl-prefix").length&&u.prepend('<div class="dl-prefix">'+i.suggestionPrefix+"</div>"),u.show(),i.autoSelectFirst&&(this.selectedIndex=0,u.scrollTop(0),u.children("."+o).first().addClass(a)),this.visible=!0,this.findBestHint())}else this.options.showNoSuggestionNotice?this.noSuggestions():this.hide()},noSuggestions:function(){var e=this.options.beforeRender,i=t(this.suggestionsContainer),s=t(this.noSuggestionsContainer);this.adjustContainerWidth(),s.detach(),i.find(".dl-items").empty(),i.find(".dl-prefix").remove(),i.prepend(s),t.isFunction(e)&&e.call(this.element,i,this.suggestions),this.fixPosition(),i.show(),this.visible=!0},adjustContainerWidth:function(){var e,i=this.options,s=t(this.suggestionsContainer);"auto"===i.width?(e=this.el.outerWidth(),s.css("width",e>0?e:300)):"flex"===i.width&&s.css("width","")},findBestHint:function(){var e=this.el.val().toLowerCase(),i=null;e&&(t.each(this.suggestions,(function(t,s){var n=0===s.address_value.toLowerCase().indexOf(e);return n&&(i=s),!n})),this.onHint(i))},onHint:function(e){var i=this.options.onHint,s="";e&&(s=this.currentValue+e.address_value.substr(this.currentValue.length)),this.hintValue!==s&&(this.hintValue=s,this.hint=e,t.isFunction(i)&&i.call(this.element,s))},verifySuggestionsFormat:function(e){return e.length&&"string"==typeof e[0]?t.map(e,(function(t){return{value:t,data:null}})):e},validateOrientation:function(e,i){return e=t.trim(e||"").toLowerCase(),-1===t.inArray(e,["auto","bottom","top"])&&(e=i),e},processResponse:function(t,e,i){var s=[],n=this.options;s=t.data?t.data.items:[],s=this.verifySuggestionsFormat(s),n.noCache||(this.cachedResponse[i]=s,n.preventBadQueries&&!s.length&&this.badQueries.push(e)),e===this.getQuery(this.currentValue)&&(this.suggestions=s,this.suggest())},activate:function(e){var i,s=this.classes.selected,n=t(this.suggestionsContainer),o=n.find("."+this.classes.suggestion);return n.find("."+s).removeClass(s),this.selectedIndex=e,-1!==this.selectedIndex&&o.length>this.selectedIndex?(i=o.get(this.selectedIndex),t(i).addClass(s),i):null},selectHint:function(){var e=t.inArray(this.hint,this.suggestions);this.select(e)},select:function(t){this.hide(),this.onSelect(t)},moveUp:function(){if(-1!==this.selectedIndex)return 0===this.selectedIndex?(t(this.suggestionsContainer).children("."+this.classes.suggestion).first().removeClass(this.classes.selected),this.selectedIndex=-1,this.ignoreValueChange=!1,this.el.val(this.currentValue),void this.findBestHint()):void this.adjustScroll(this.selectedIndex-1)},moveDown:function(){this.selectedIndex!==this.suggestions.length-1&&this.adjustScroll(this.selectedIndex+1)},adjustScroll:function(e){var i=this.activate(e);if(i){var s,n,o,a=t(i).outerHeight();s=i.offsetTop,o=(n=t(this.suggestionsContainer).scrollTop())+this.options.maxHeight-a,s<n?t(this.suggestionsContainer).scrollTop(s):s>o&&t(this.suggestionsContainer).scrollTop(s-this.options.maxHeight+a),this.options.preserveInput||(this.ignoreValueChange=!0,this.el.val(this.getValue(this.suggestions[e].value))),this.onHint(null)}},onSelect:function(e){var i=this.options.onSelect,s=this.suggestions[e];this.currentValue=this.getValue(s.address_value),this.currentValue===this.el.val()||this.options.preserveInput||this.el.val(this.currentValue),this.onHint(null),this.suggestions=[],this.selection=s,t.isFunction(i)&&i.call(this.element,s)},getValue:function(t){var e,i,s=this.options.delimiter;return s?1===(i=(e=this.currentValue).split(s)).length?t:e.substr(0,e.length-i[i.length-1].length)+t:t},dispose:function(){this.el.off(".autocomplete").removeData("autocomplete"),t(window).off("resize.autocomplete",this.fixPositionCapture),t(this.suggestionsContainer).remove()}},t.fn.devbridgeAutocomplete=function(e,i){var s="autocomplete";return arguments.length?this.each((function(){var n=t(this),o=n.data(s);"string"==typeof e?o&&"function"==typeof o[e]&&o[e](i):(o&&o.dispose&&o.dispose(),o=new l(this,e),n.data(s,o))})):this.first().data(s)},t.fn.autocomplete||(t.fn.autocomplete=t.fn.devbridgeAutocomplete)})?s.apply(e,n):s)||(t.exports=o)}()},function(t,e){t.exports=jQuery}]);